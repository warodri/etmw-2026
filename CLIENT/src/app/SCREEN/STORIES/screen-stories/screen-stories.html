<div class="container-fluid">
    
    <div class="col-12 col-md-7 col-lg-7 mx-auto px-3 px-md-0">
        
        <app-mobile-header></app-mobile-header>

        <div class="stories-feed">
            @for (story of stories(); track story.id) {
                <div class="story-card" #storyItem [attr.data-story-id]="story.id"
                    (touchstart)="onTouchStart($event, story.id)"
                    (touchmove)="onTouchMove($event, story.id)"
                    (touchend)="onTouchEnd($event, story.id)">
                    
                    <div class="story-slider" [style.transform]="'translateX(' + (-story.slideIndex * 100) + '%)'">
                        <!-- Slide 1: Image + quote -->
                        <div class="story-slide">
                            <img class="story-image" [src]="story.image" [alt]="story.author">
                            <div class="story-overlay" style="max-width: 50%;">
                                <div class="story-title">{{ story.title }}</div>
                                <div class="story-subtitle">{{ story.subtitle }}</div>
                                <div class="story-quote">{{ story.quote }}</div>
                                <div class="story-body">{{ story.body }}</div>
                                <div class="story-actions">
                                    <button class="btn btn-sm btn-light rounded-pill">‚ù§Ô∏è Like</button>
                                    <button class="btn btn-sm btn-light rounded-pill">üí¨ Discuss</button>
                                    <button class="btn btn-sm btn-light rounded-pill">‚û°Ô∏è I want more!</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Slide 2: Audio preview -->
                        <div class="story-slide">
                            <img class="story-image" [src]="story.audioImage" [alt]="story.author">
                            <div class="story-audio-bar" style="max-width: 45%;">
                                <button class="btn btn-sm btn-light rounded-circle" (click)="toggleAudio(story.id)">
                                    <i class="bi" [class.bi-play-fill]="!story.isPlaying" [class.bi-pause-fill]="story.isPlaying"></i>
                                </button>
                                <div class="story-audio-progress">
                                    <div class="story-audio-progress-fill" [style.width.%]="story.progress"></div>
                                </div>
                            </div>
                            <button class="story-audio-fab" (click)="toggleMute(story.id)">
                                <i class="bi" [class.bi-volume-up]="!story.isMuted" [class.bi-volume-mute]="story.isMuted"></i>
                            </button>
                            <div class="story-overlay story-overlay-compact" style="max-width: 50%;">
                                <div class="story-title">{{ story.title }}</div>
                                <div class="story-subtitle">{{ story.subtitle }}</div>
                                <div class="story-quote">{{ story.quote }}</div>
                                <div class="story-body story-body-scroll"
                                     [class.expanded]="story.expanded"
                                     (click)="toggleExpand(story.id)">
                                    {{ story.audioText }}
                                </div>
                                <div class="story-actions">
                                    <button class="btn btn-sm btn-light rounded-pill">‚ù§Ô∏è Like</button>
                                    <button class="btn btn-sm btn-light rounded-pill">üí¨ Discuss</button>
                                    <button class="btn btn-sm btn-light rounded-pill">‚û°Ô∏è I want more!</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="story-indicators">
                        <div class="dot" [class.active]="story.slideIndex === 0"></div>
                        <div class="dot" [class.active]="story.slideIndex === 1"></div>
                    </div>
                </div>
            }
        </div>

    </div>
</div>

<app-mobile-footer></app-mobile-footer>
