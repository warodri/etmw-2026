<h5 class="fw-bold mb-3">
    <i class="bi bi-fire text-danger"></i> Popular Threads
</h5>

@if (loading()) {
    <div class="small text-gray-400 mb-3">Loading...</div>
}

@if (error()) {
    <div class="small text-danger mb-3">{{ error() }}</div>
}

@if (!loading() && popularThreads().length === 0 && !error()) {
    <div class="small text-gray-400 mb-3">No popular threads yet.</div>
}

@for (thread of popularThreads(); track thread._id) {
    <div class="bg-secondary rounded-4 p-3 mb-3 pointer" (click)="openThread(thread)">
        <div class="d-flex gap-3">
            <img
                [src]="userProfile(thread)"
                class="rounded-circle flex-shrink-0 pointer"
                style="width: 40px; height: 40px; object-fit: cover;"
                (click)="gotoUserProfile(thread, $event)"
            />
            <div class="flex-grow-1 min-w-0">
                <div class="fw-bold mb-1">{{ userName(thread) }}</div>
                <div
                    class="small text-gray-400 mb-2"
                    style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;"
                >
                    {{ thread.text || 'Voice message / attachment thread' }}
                </div>
                <div class="d-flex gap-3 small text-gray-400">
                    <span><i class="bi bi-chat-fill"></i> {{ thread.replyCount || 0 }}</span>
                    <span><i class="bi bi-heart-fill"></i> {{ thread.likeCount || 0 }}</span>
                    <span><i class="bi bi-clock"></i> {{ timeAgo(thread) }}</span>
                </div>
            </div>
        </div>
    </div>
}
